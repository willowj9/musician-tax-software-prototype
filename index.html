<script>
    const CLIENT_ID = "your-client-id-from-calendar-env";
    const API_KEY = "your-api-key-from-calendar-env";

    async function initClient() {
        try {
            await gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],
                scope: "https://www.googleapis.com/auth/calendar.readonly",
            });

            const isSignedIn = gapi.auth2.getAuthInstance().isSignedIn.get();
            updateSignInStatus(isSignedIn);
            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
        } catch (error) {
            console.error("Error initializing Google API client:", error);
        }
    }
</script>

<body>
    <div class="container">
        <div class="header">
            <h1>Musician Tax Dashboard</h1>
            <p>Track your gigs, payments, and expenses effortlessly</p>
        </div>

        <div class="dashboard">
            <div class="card">
                <h2>Total Income</h2>
                <p id="total-income">$4,200</p>
            </div>
            <div class="card">
                <h2>Total Mileage</h2>
                <p id="total-mileage">320 miles</p>
            </div>
            <div class="card">
                <h2>Pending Payments</h2>
                <p id="pending-payments">2 events</p>
            </div>
            <div class="card">
                <h2>Tax Deductions</h2>
                <p id="tax-deductions">$960</p>
            </div>
        </div>

        <div class="event-details">
            <h3>Upcoming Events</h3>
            <select id="filter-status" onchange="filterEvents()">
                <option value="all">All</option>
                <option value="pending">Pending Payment</option>
                <option value="paid">Paid</option>
            </select>
            <table class="event-table" id="event-table">
                <thead>
                    <tr>
                        <th>Event</th>
                        <th>Date</th>
                        <th>Location</th>
                        <th>Income</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-status="pending">
                        <td>Gig at XYZ Jazz Club</td>
                        <td>2024-01-05</td>
                        <td>XYZ Jazz Club</td>
                        <td>$200</td>
                        <td>Pending Payment</td>
                    </tr>
                    <tr data-status="paid">
                        <td>Lesson at ABC School</td>
                        <td>2024-01-06</td>
                        <td>ABC School</td>
                        <td>$100</td>
                        <td>Paid</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="mileage-calculator">
            <h3>Calculate Mileage Deduction</h3>
            <input type="number" id="miles" placeholder="Enter miles driven" />
            <button onclick="calculateDeduction()">Calculate</button>
            <p id="mileage-output"></p>
        </div>

        <div class="footer">
            &copy; 2024 Musician Tax Software | Simplify your finances
        </div>
    </div>

    <script>
        // Filter events by status
        function filterEvents() {
            const filter = document.getElementById("filter-status").value;
            const rows = document.querySelectorAll("#event-table tbody tr");

            rows.forEach(row => {
                const status = row.getAttribute("data-status");
                row.style.display = filter === "all" || status === filter ? "" : "none";
            });
        }

        // Calculate mileage deduction
        function calculateDeduction() {
            const miles = document.getElementById("miles").value;
            const rate = 0.655; // Standard IRS mileage rate per mile in 2024
            const deduction = (miles * rate).toFixed(2);

            document.getElementById("mileage-output").innerText = 
                `Your deduction for ${miles} miles is $${deduction}.`;
        }
    </script>
</body>
